# Automated Leaked Credentials & Code Exposure Detection System  
### Hybrid API-Based + Open-Source OSINT Monitoring

## Overview
This document outlines a complete solution for detecting leaked credentials, API keys, and sensitive company data on the public internet.  
It combines:

- Google Custom Search API (paid, cloud-based)
- Open-source OSINT tools (Self-hosted)
- Automated scheduling and alerting mechanisms
- Optional SIEM integration (e.g., Wazuh)

This system monitors:
- GitHub  
- GitLab  
- Pastebin  
- JustPaste.it  
- Public forums  
- Cached/unindexed pages  
- Dark web mirrors (via SpiderFoot modules)

---

# 1. Objectives

- Detect leaked secrets and credentials early  
- Identify exposed configuration files or code fragments  
- Find unauthorised uploads referencing internal systems  
- Provide actionable alerts to the Security/GRC team  
- Generate audit-ready evidence for incident response  
- Support regulatory and contractual obligations  

---

# 2. Option A — Google Custom Search API (Paid)

Best suited for organisations already integrated with Google Cloud.

### Capabilities
- Queries public sources for sensitive keywords  
- Searches paste sites, GitHub, and other repositories  
- Detects leaked API keys, tokens, credentials  
- Automated scanning via Python scripts  
- Low cost: ~$5 per 1,000 queries  

---

## 2.1 Setup Steps

### **1. Create Google Cloud Project**
https://console.cloud.google.com

### **2. Enable Custom Search API**
Google Cloud Console → APIs & Services → Enable APIs → Custom Search API.

### **3. Generate API Key**
APIs & Services → Credentials → “Create API Key”.

### **4. Configure Programmable Search Engine**
https://programmablesearchengine.google.com/

Add sites:

*.pastebin.com
*.justpaste.it
*.github.com
*.gitlab.com



Obtain:
- API Key  
- Search Engine ID  

---

## 2.2 Automated Script (Python or similar)

Core tasks:
- Query API for company keywords  
- Parse JSON responses  
- Match results via regex  
- Save output to local DB or SIEM  
- Send alerts via email, Slack, or webhook  

Run via cron:

0 */12 * * * /usr/bin/python3 leak_monitor.py


---

# 3. Option B — Self-Hosted OSINT Monitoring Stack

This stack allows unlimited scanning without API costs.

### Tools included:
- **PasteHunter** — Paste site monitoring  
- **SpiderFoot** — Broad OSINT scanning including dark web  
- **Shhgit** — Real-time GitHub secret detection  

---

## 3.1 PasteHunter

### What it does
- Scans paste sites (Pastebin, JustPaste.it)  
- Uses regex to detect secrets  
- Sends alerts to Slack/email  

### Keywords example

INTERNAL_API_KEY
AWS_SECRET_KEY
DB_PASSWORD


### Automation
Cron job every X minutes/hour.

---

## 3.2 SpiderFoot

### What it does
- Collects OSINT on:
  - Emails  
  - Domains  
  - References on forums  
  - Leaked credentials  
  - Dark web  
  - GitHub mentions  

Includes:
- Web interface  
- Automation engine  
- Alerts  

---

## 3.3 Shhgit

### What it does
- Monitors GitHub in real time  
- Finds:
  - Hardcoded secrets  
  - API tokens  
  - Passwords  
  - Database URLs  

Supports webhook alerts.

---

# 4. Centralised Alerting

### Option A — Slack Alerts
- Create channel: `#security-alerts`  
- Add webhook  
- Connect all tools via JSON payload

### Option B — Email Alerts
- Best for lightweight implementations

### Option C — Webhooks into SIEM (e.g., Wazuh)
- Enables correlation  
- Historical evidence  
- Custom dashboards  

---

# 5. Full Architecture Summary

| Tool | Source | Detects | Alerting |
|------|--------|----------|----------|
| Google CSE | Public web | Secrets, leaks | Email/Webhook |
| PasteHunter | Paste sites | Leaked credentials | Slack/Email |
| SpiderFoot | OSINT & dark web | Accounts, breaches | Email/Web UI |
| Shhgit | GitHub | Code leaks, secrets | Slack/Webhook |

---

# 6. Documentation Requirements (GRC Alignment)

For audit readiness:
- Weekly OSINT monitoring report  
- Evidence of alerts reviewed  
- IR tickets for detected leaks  
- Third-party notifications if needed  
- Risk assessments for repeated leaks  

---

# 7. Summary

This system provides proactive monitoring and strong coverage across diverse public sources.  
It demonstrates combined expertise in:

- Threat intelligence  
- Automation engineering  
- GRC and incident response  
- Vendor evaluation  
- OSINT investigation  
